# Maintainer: Stefan Hansson <newbyte@postmarketos.org>
pkgname=dint
pkgver=0.0.1_git20251003
pkgrel=1
pkgdesc="postmarketOS deviceinfo validator and linter"
url="https://gitlab.postmarketos.org/Newbyte/dint"
arch="all"
license="EUPL-1.2"
makedepends="cargo cargo-auditable"
_commit="70882e1494110eb1d4a97a183efef7eebd2d5865"
source="https://gitlab.postmarketos.org/Newbyte/dint/-/archive/$_commit/hello-world-rust-$_commit.tar.bz2"
builddir="$srcdir/dint-$_commit"
options="!pmb:crossdirect"

prepare() {
	default_prepare

	cargo fetch --locked
}

build() {
	cargo auditable build --release --frozen
}

check() {
	cargo test --frozen
}

package() {
	install -Dm755 target/release/dint \
		-t "$pkgdir"/usr/bin
	install -Dm644 deviceinfo_schema.toml \
		-t "$pkgdir"/usr/share/dint
}

sha512sums="
36dde57c8cdc45734ed906e53c41178e803e81045ad7a0de5e796ca81d524f4ee42ce03df98455c8ad704ae3f19994cd46f5835a297fdf765f443bf3a19f2826  hello-world-rust-70882e1494110eb1d4a97a183efef7eebd2d5865.tar.bz2
"
